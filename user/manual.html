<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>scons-gnu-arguments</title><link rel="stylesheet" type="text/css" href="docbook.css"></link><link rel="stylesheet" type="text/css" href="scons-gnu-arguments.css"></link><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"></meta></head><body><section class="article" id="idm46191905967216"><div class="titlepage"><div><div><h2 class="title">scons-gnu-arguments</h2></div><div><h3 class="subtitle"><em>User's 
	Manual</em></h3></div><div><div class="author"><h3 class="author">Paweł 
			Tomulik</h3><code class="email">&lt;<a class="email" href="mailto:ptomulik@meil.pw.edu.pl">ptomulik@meil.pw.edu.pl</a>&gt;</code></div></div><div><p class="pubdate">2015-11-08</p></div></div><hr></hr></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="section"><a href="#sec-intro">1. Introduction</a></span></li><li><span class="section"><a href="#idm46191906777952">2. Quick 
		Start</a></span></li><li><span class="section"><a href="#idm46191906691824">3. Using 
		SConsGnuArguments</a></span></li><li><span class="section"><a href="#idm46191903469728">4. Submodules 
		in SConsGnuArguments</a></span><ul><li><span class="section"><a href="#idm46191903468560">4.1. <code class="literal">InstallDirs</code></a></span></li><li><span class="section"><a href="#idm46191903423872">4.2. <code class="literal">AltPrograms</code></a></span></li></ul></li></ul></div><section class="section" id="sec-intro"><div class="titlepage"><div><div><h2 class="title" style="clear: both">1. Introduction</h2></div></div></div><p>The 
		<span class="package">scons-gnu-arguments</span> 
		package is an extension to 
		<span class="productname"><a class="link" href="http://scons.org" target="_top">SCons</a></span> 
		which provides SCons with several command-line variables and options 
		defined by GNU standards.</p><p>Many 
		open-source projects use 
		<span class="productname">autotools</span> 
		and 
		<span class="productname">make</span> 
		to build software. These tools provide a set of standard command-line 
		options and variables such as 
		<code class="literal">--prefix</code> 
		or 
		<code class="literal">CC</code>. 
		Their users may easily configure project with a custom installation 
		prefix 
		(<code class="code">./configure 
		--prefix=/usr/bin</code>) or chose specific compiler via command-line 
		variables 
		(<code class="code">make 
		CC=clang</code>). All these options are very mature and well-known to 
		open-source developers and package maintainers. They are not avaiable 
		in SCons, however, because SCons is not 
		<span class="productname">make</span> 
		nor 
		<span class="productname">automake</span>. 
		This is understandable, but also frustrates some developers and 
		package mainainers that are used to GNU tools. As for the moment, 
		there is no cheap and easy way to add the multitude of existing GNU 
		comman-line options to scons. This package tries to change 
		this.</p><p>WIth 
		<span class="package">scons-gnu-arguments</span> you may add groups of 
		predefined GNU command line options/variables to SCons with just a 
		few lines of code.</p><p>The 
		package only works in pair with 
		<a class="link" href="https://github.com/ptomulik/scons-arguments" target="_top">scons-arguments</a>, 
		so 
		<a class="link" href="https://github.com/ptomulik/scons-arguments" target="_top">scons-arguments</a> 
		must be installed along with 
		<a class="link" href="https://github.com/ptomulik/scons-gnu-arguments" target="_top">scons-gnu-arguments</a> 
		in a project that uses GNU arguments.</p></section><section class="section" id="idm46191906777952"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2. Quick 
		Start</h2></div></div></div><p>It's 
		recommended to also take a look at the 
		<a class="link" href="https://github.com/ptomulik/scons-arguments" target="_top">scons-arguments</a> 
		package, as some functions appearing in the following examples are 
		explained in 
		<a class="link" href="http://ptomulik.github.io/scons-arguments/user/manual.html" target="_top">that 
		package's documentation</a>.</p><p>As 
		a quick example, let us write a simple SConstruct file which installs 
		a shell script in an appropriate installation directory, as defined 
		by GNU standards (in 
		<code class="varname">$bindir</code>, 
		if you know what I mean). The installation path shall be configurable 
		via command-line variables 
		<code class="varname">prefix</code>, 
		<code class="varname">exec_prefix</code> 
		and 
		<code class="varname">bindir</code> 
		as it usually happens in projects based on 
		<span class="productname">autotools</span>.</p><div class="example" id="idm46191907259872"><div class="example-title">Example 1. Install 
			shell script in $bindir</div><div class="example-contents"><p>Write 
			the follwing two files, 
			<code class="filename">hello</code>:</p><pre class="programlisting">#! /bin/sh
echo 'hello world!'</pre><p>and 
			<code class="filename">SConstruct</code>:</p><pre class="programlisting"># SConstruct
import SConsGnuArguments.InstallDirs

env = Environment()                                   # SCons environment, you should know it
var = Variables()                                     # container for SCons CLI variables

decls = SConsGnuArguments.InstallDirs.Declarations() # declare arguments
args  = decls.Commit(env, var, True)                  # say "no more arguments" to scons
args.Postprocess(env, var, True)                      # transfer CLI arguments to env

# The rest is quite usual
hello_i = env.InstallAs("${bindir}/hello", 'hello')   # NOTE the ${bindir}

env.Alias('install', hello_i)
env.AlwaysBuild('install')</pre><p>Now 
			build the project and install the compiled program as follows:</p><pre class="screen"><code class="prompt">ptomulik@barakus:$ </code><span class="command"><strong>scons</strong></span> -Q install prefix=preinst/usr
Install file: "hello" as "preinst/usr/bin/hello"
</pre><p>Note, 
			that the installation directory may be changed with 
			<code class="varname">prefix</code>, 
			<code class="varname">exec_prefix</code> 
			and 
			<code class="varname">bindir</code> 
			CLI variables.</p></div></div><br class="example-break"></br><p>If 
		you wonder what just happened, let's define appropriate help 
		option to document our CLI variables we've just created</p><div class="example" id="idm46191905609040"><div class="example-title">Example 2. Install 
			shell script in $bindir, also add --help-variables option to 
			SConstruct</div><div class="example-contents"><pre class="programlisting"># SConstruct
import SConsGnuArguments.InstallDirs

env = Environment()                                   # SCons environment, you should know it
var = Variables()                                     # container for SCons CLI variables

decls = SConsGnuArguments.InstallDirs.Declarations() # declare arguments
args  = decls.Commit(env, var, True)                  # say "no more arguments" to scons
args.Postprocess(env, var, True)                      # transfer CLI arguments to env

# The following adds --help-variables option which documents CLI variables.
AddOption( '--help-variables', dest='help_variables', action='store_true',
         help='print help for CLI variables' )
if GetOption('help_variables'):
  print args.GenerateVariablesHelpText(var, env)
  Exit(0)

# The rest is quite usual
hello_i = env.InstallAs("${bindir}/hello", 'hello')   # NOTE the ${bindir}

env.Alias('install', hello_i)
env.AlwaysBuild('install')</pre><p>Now 
			dump some info about variables to the console</p><pre class="screen"><code class="prompt">ptomulik@barakus:$ </code><span class="command"><strong>scons</strong></span> -Q --help-variables

docdir: The directory for installing documentation files (other than Info) for this package.
    default: ${datarootdir}/doc/${install_package}
    actual: /usr/local/share/doc/
&lt;... lot of output here ...&gt;
prefix: Installation prefix
    default: /usr/local
    actual: /usr/local
&lt;... lot of output ...&gt;
prefix: Installation prefix
    default: /usr/local
    actual: /usr/local
&lt;... lot of output ...&gt;
bindir: The directory for installing executable programs that users can run.
    default: ${exec_prefix}/bin
    actual: /usr/local/bin
</pre></div></div><br class="example-break"></br><p>In 
		the above example, we have used arguments from the submodule 
		<code class="literal">InstallDirs</code>, 
		which defines variables for GNU installation directories. The package 
		<code class="literal">SConsGnuArguments</code> 
		contains several submodules, each providing some subset of 
		standarized GNU command-line arguments. They will be discussed in 
		next sections.</p></section><section class="section" id="idm46191906691824"><div class="titlepage"><div><div><h2 class="title" style="clear: both">3. Using 
		SConsGnuArguments</h2></div></div></div><p>There 
		are several submodules in the 
		<code class="literal">SConsGnuArguments</code>, 
		each providing a subset of predefined GNU command-line arguments. For 
		example, 
		<a class="link" href="http://www.gnu.org/prep/standards/html_node/Directory-Variables.html" target="_top">GNU 
		directory variables</a> are defined in a module named 
		<code class="literal">SConsGnuArguments.InstallDirs</code>. 
		Each relevant submodule provides two public functions</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="function">Names()</code> 
				- which lists all argument names defined by the module,</p></li><li class="listitem"><p><code class="function">Declarations()</code> 
				- which provides declarations of SCons arguments predefined by the 
				submodule.</p></li></ul></div><p>We'll 
		focus only on the second function, the first one shall be quite 
		obvious. The simplest use is to declare all the arguments predefined 
		by a submodule</p><div class="informalexample"><pre class="programlisting">import SConsGnuArguments.&lt;Submodule&gt;
decls = SConsGnuArguments.&lt;Submodule&gt;.Declarations()</pre></div><p>This 
		declares all arguments predefined in the 
		<code class="literal">&lt;Submodule&gt;</code> 
		(substitute 
		<code class="literal">&lt;Submodule&gt;</code> 
		with an actual submodule name). The full list of arguments predefined 
		by particular submodules may be found in 
		<a class="link" href="https://ptomulik.github.io/scons-gnu-arguments/api/" target="_top">API 
		documentation</a>. If you want only some of them, you may define 
		special filter to allow only particular arguments. Currently filters 
		are supported that use argument names. Most generic approach is to 
		create a callable object (lambda, function, whatever) and pass it as 
		a 
		<em class="parameter"><code>name_filter</code></em> 
		keyword argument to 
		<code class="function">Declarations()</code>.</p><div class="informalexample"><pre class="programlisting">allowed = ['prefix', 'exec_prefix', 'bindir']
decls = SConsGnuArguments.&lt;Submodule&gt;.Declarations(name_filter = lambda s : s in allowed)</pre></div><p>The 
		<em class="parameter"><code>name_filter</code></em> 
		should be a callable which takes a string (argument's name) and 
		returns 
		<code class="literal">True</code> 
		(to include argument) or 
		<code class="literal">False</code> 
		(to exclude argument). The above example may be made simpler, because 
		sequences may also be used as a name filter, so the same may be 
		achieved with</p><p>
			</p><div class="informalexample"><pre class="programlisting">decls = SConsGnuArguments.&lt;Submodule&gt;.Declarations(name_filter = [ 'prefix', 'exec_prefix', 'bindir' ])</pre></div><p>
		</p><p>Arguments 
		declared with 
		<code class="function">SConsGnuArguments.&lt;Submodule&gt;.Declarations()</code> 
		may create a command-line variables 
		(<code class="literal">scons 
		variable=value</code>) and/or command-line options 
		(<code class="literal">scons 
		--option=value</code>). For example, the submodule 
		<code class="literal">InstallDirs</code> 
		only creates command-line variables. This may be changed, for example 
		you may wish to have command-line options generated by 
		<code class="literal">InstallDirs</code> 
		(or you may want to have both, CLI variables and options, it's 
		not a problem). To enable command-line options and disable variables, 
		manipulate 
		<em class="parameter"><code>var_key_transform</code></em> 
		and 
		<em class="parameter"><code>opt_key_transform</code></em> 
		parameters as follows.</p><div class="informalexample"><pre class="programlisting">decls = SConsGnuArguments.&lt;Submodule&gt;.Declarations(var_key_transform = False, opt_key_transform = True)</pre></div><p>This 
		should generate command-line options such as 
		<code class="option">--prefix</code> 
		or 
		<code class="option">--exec-prefix</code> 
		and prevent from generating command-line variables such as 
		<code class="varname">prefix</code> 
		and 
		<code class="varname">exec_prefix</code>. 
		Note that command-line options can't be saved to a file by using 
		<a class="link" href="https://github.com/ptomulik/scons-arguments" target="_top">scons-arguments</a> 
		API, whereas command-line variables may be saved easily.</p><p>By 
		default construction variables, command-line variables and 
		command-line options inherit their names directly from their 
		arguments. That is, if we have an argument named 
		<code class="varname">prefix</code>, 
		then its corresponding construction variable will be named 
		<code class="varname">prefix</code> 
		as well as command-line variable and command-line option (note, that 
		command-line options get lowercased by default). This may be changed 
		easily, for example there is a very quick and easy way to add 
		prefixes/suffixes to the generated names. For example, we may want to 
		add 
		<code class="literal">"GNU_"</code> 
		prefix to corresponding construction variables, such that argument, 
		like 
		<code class="varname">bindir</code>, 
		will be seen as 
		<code class="varname">GNU_bindir</code> 
		in SCons environment. This may be achieved with 
		<em class="parameter"><code>env_key_prefix</code></em> 
		parameter as follows.</p><div class="informalexample"><pre class="programlisting">decls = SConsGnuArguments.&lt;Submodule&gt;.Declarations(env_key_prefix = 'GNU_')</pre></div><p>The 
		possible arguments that allow to customize name generation for 
		construction variables, command-line variables and command-line 
		options are summarized in the following table</p><div class="informaltable"><table><tr>
				<th>Parameter</th>
				<th>Description</th>
			</tr><tr>
				<td><em class="parameter"><code>env_key_prefix</code></em></td>
				<td>Prefix to be prepended to 
				the name of construction variable</td>
			</tr><tr>
				<td><em class="parameter"><code>env_key_suffix</code></em></td>
				<td>Suffix to be appended to 
				the name of construction variable</td>
			</tr><tr>
				<td><em class="parameter"><code>var_key_prefix</code></em></td>
				<td>Prefix to be prepended to 
				the name of command-line variable</td>
			</tr><tr>
				<td><em class="parameter"><code>var_key_suffix</code></em></td>
				<td>Suffix to be appended to 
				the name of command-line variable</td>
			</tr><tr>
				<td><em class="parameter"><code>opt_key_prefix</code></em></td>
				<td>Prefix to be prepended to 
				the key identifying command-line option</td>
			</tr><tr>
				<td><em class="parameter"><code>opt_key_suffix</code></em></td>
				<td>Suffix to be appended to 
				the key identifying command-line option</td>
			</tr><tr>
				<td><em class="parameter"><code>opt_name_prefix</code></em></td>
				<td>Prefix to be prepended to 
				the name of command-line option</td>
			</tr><tr>
				<td><em class="parameter"><code>opt_name_suffix</code></em></td>
				<td>Suffix to be appended to 
				the name of command-line option</td>
			</tr><tr>
				<td><em class="parameter"><code>opt_prefix</code></em></td>
				<td>Prefix to be used as a 
				starter for command-line option, usually 
				<code class="literal">'--'</code></td>
			</tr><tr>
				<td><em class="parameter"><code>env_key_transform</code></em></td>
				<td>A callable object used to 
				generate names of construction variables based on argument names. 
				Providing this usually ignores all the prefix/suffix arguments. It 
				may also be set to 
				<code class="literal">True</code> 
				to force the usage of default generator, or to 
				<code class="literal">False</code> 
				to disable the generation of construction variables.</td>
			</tr><tr>
				<td><em class="parameter"><code>var_key_transform</code></em></td>
				<td>A callable object used to 
				generate names of command-line variables based on argument names. 
				Providing this usually ignores all the prefix/suffix arguments. It 
				may also be set to 
				<code class="literal">True</code> 
				to force the usage of default generator, or to 
				<code class="literal">False</code> 
				to disable the generation of command-line variables.</td>
			</tr><tr>
				<td><em class="parameter"><code>opt_key_transform</code></em></td>
				<td>A callable object used to 
				generate keys identifying command-line options based on argument 
				names. Providing this usually ignores all the prefix/suffix 
				arguments. It may also be set to 
				<code class="literal">True</code> 
				to force the usage of default generator, or to 
				<code class="literal">False</code> 
				to disable the generation of command-line options.</td>
			</tr><tr>
				<td><em class="parameter"><code>option_transform</code></em></td>
				<td>A callable object used to 
				generate options names based on argument names. Providing this 
				usually ignores all the prefix/suffix arguments.</td>
			</tr></table></div></section><section class="section" id="idm46191903469728"><div class="titlepage"><div><div><h2 class="title" style="clear: both">4. Submodules 
		in SConsGnuArguments</h2></div></div></div><p>The 
		following subsections describe shortly submodules found in the 
		SConsGnuArguments package and list arguments they define.</p><section class="section" id="idm46191903468560"><div class="titlepage"><div><div><h3 class="title">4.1. <code class="literal">InstallDirs</code></h3></div></div></div><p>Defines 
			<a class="link" href="http://www.gnu.org/prep/standards/html_node/Directory-Variables.html" target="_top">GNU 
			directory variables</a>, also called GNU installation 
			directories, which are used mainly by GNU-compatible installers. The 
			arguments defined by submodule by default create command-line 
			variables (and no command-line options).</p><div class="informalexample"><p>Declaring arguments predefined in 
				<code class="literal">InstallDirs</code></p><pre class="programlisting">decls = SConsGnuArguments.InstallDirs.Declarations(...)</pre></div><p>Arguments 
			provided by 
			<code class="literal">InstallDirs</code>:</p><div class="informaltable"><table><tr>
					<td><code class="literal">prefix</code></td>
					<td>Installation prefix</td>
				</tr><tr>
					<td><code class="literal">exec_prefix</code></td>
					<td>Installation prefix for 
					executable files</td>
				</tr><tr>
					<td><code class="literal">bindir</code></td>
					<td>The directory for 
					installing executable programs that users can run.</td>
				</tr><tr>
					<td><code class="literal">sbindir</code></td>
					<td>The directory for 
					installing executable programs that can be run from the shell, but 
					are only generally useful to system administrators.</td>
				</tr><tr>
					<td><code class="literal">libexecdir</code></td>
					<td>The directory for 
					installing executable programs to be run by other programs rather 
					than by users.</td>
				</tr><tr>
					<td><code class="literal">datarootdir</code></td>
					<td>The root of the 
					directory tree for read-only architecture-independent data 
					files.</td>
				</tr><tr>
					<td><code class="literal">datadir</code></td>
					<td>The directory for 
					installing idiosyncratic read-only architecture-independent data 
					files for this program.</td>
				</tr><tr>
					<td>s<code class="literal">ysconfdir</code></td>
					<td>The directory for 
					installing read-only data files that pertain to a single machine - 
					that is to say, files for configuring a host.</td>
				</tr><tr>
					<td>s<code class="literal">haredstatedir</code></td>
					<td>The directory for 
					installing architecture-independent data files which the programs 
					modify while they run.</td>
				</tr><tr>
					<td>
						<div class="literallayout"><p><code class="literal">localstatedir</code></p></div>
					</td>
					<td>The directory for 
					installing data files which the programs modify while they run, 
					and that pertain to one specific machine.</td>
				</tr><tr>
					<td><code class="literal">includedir</code></td>
					<td>The directory for 
					installing header files to be included by user programs with the C 
					#include preprocessor directive.</td>
				</tr><tr>
					<td><code class="literal">oldincludedir</code></td>
					<td>The directory for 
					installing #include header files for use with compilers other than 
					GCC.</td>
				</tr><tr>
					<td><code class="literal">docdir</code></td>
					<td>The directory for 
					installing documentation files (other than Info) for this 
					package.</td>
				</tr><tr>
					<td><code class="literal">infodir</code></td>
					<td>The directory for 
					installing the Info files for this package.</td>
				</tr><tr>
					<td><code class="literal">htmldir</code></td>
					<td>Directory for installing 
					documentation files in the html format.</td>
				</tr><tr>
					<td><code class="literal">dvidir</code></td>
					<td>Directory for installing 
					documentation files in the dvi format.</td>
				</tr><tr>
					<td><code class="literal">pdfdir</code></td>
					<td>Directory for installing 
					documentation files in the pdf format.</td>
				</tr><tr>
					<td><code class="literal">psdir</code></td>
					<td>Directory for installing 
					documentation files in the ps format.</td>
				</tr><tr>
					<td><code class="literal">libdir</code></td>
					<td>The directory for object 
					files and libraries of object code.</td>
				</tr><tr>
					<td><code class="literal">lispdir</code></td>
					<td>The directory for 
					installing any Emacs Lisp files in this package.</td>
				</tr><tr>
					<td><code class="literal">localedir</code></td>
					<td>The directory for 
					installing locale-specific message catalogs for this package.</td>
				</tr><tr>
					<td><code class="literal">mandir</code></td>
					<td>The top-level directory 
					for installing the man pages (if any) for this package.</td>
				</tr><tr>
					<td><code class="literal">man1dir</code> 
					.. 
					<code class="literal">man9dir</code></td>
					<td>Simmilar to mandir</td>
				</tr><tr>
					<td><code class="literal">man1ext</code> 
					.. 
					<code class="literal">man9ext</code></td>
					<td>Extensions for manpage 
					files.</td>
				</tr><tr>
					<td><code class="literal">pkgdatadir</code></td>
					<td>The directory for 
					installing idiosyncratic read-only architecture-independent data 
					files for this program.</td>
				</tr><tr>
					<td><code class="literal">pkgincludedir</code></td>
					<td>The directory for 
					installing header files to be included by user programs with the C 
					#include preprocessor directive.</td>
				</tr><tr>
					<td><code class="literal">pkglibdir</code></td>
					<td>The directory for object 
					files and libraries of object code.</td>
				</tr><tr>
					<td><code class="literal">pkglibexecdir</code></td>
					<td>The directory for 
					installing executable programs to be run by other programs rather 
					than by users.</td>
				</tr></table></div></section><section class="section" id="idm46191903423872"><div class="titlepage"><div><div><h3 class="title">4.2. <code class="literal">AltPrograms</code></h3></div></div></div><p>Defines 
			arguments that correspond to 
			<a class="link" href="http://www.gnu.org/software/autoconf/manual/autoconf.html#Alternative-Programs" target="_top">GNU 
			autoconf alternative programs</a>. The arguments defined by 
			submodule by default create command-line variables (but no 
			command-line options).</p><div class="informalexample"><p>Declaring arguments predefined in 
				<code class="literal">AltPrograms</code></p><pre class="programlisting">decls = SConsGnuArguments.AltPrograms.Declarations(...)</pre></div><p>Arguments 
			provided by 
			<code class="literal">AltPrograms</code>:</p><div class="informaltable"><table><tr>
					<td><code class="literal">AWK</code></td>
					<td>The awk program</td>
				</tr><tr>
					<td><code class="literal">EGREP</code></td>
					<td>The egrep program</td>
				</tr><tr>
					<td><code class="literal">FGREP</code></td>
					<td>The fgrep program</td>
				</tr><tr>
					<td><code class="literal">GREP</code></td>
					<td>The grep program</td>
				</tr><tr>
					<td><code class="literal">INSTALL</code></td>
					<td>The program used to 
					install files</td>
				</tr><tr>
					<td><code class="literal">INSTALL_DATA</code></td>
					<td>The program used to 
					install data</td>
				</tr><tr>
					<td><code class="literal">INSTALL_PROGRAM</code></td>
					<td>The program used to 
					install programs</td>
				</tr><tr>
					<td><code class="literal">INSTALL_SCRIPT</code></td>
					<td>The program used to 
					install scripts</td>
				</tr><tr>
					<td><code class="literal">LEX</code></td>
					<td>The lex program</td>
				</tr><tr>
					<td><code class="literal">LEX_OUTPUT_ROOT</code></td>
					<td>The base of the file 
					name that the LEX generates</td>
				</tr><tr>
					<td><code class="literal">LEXLIB</code></td>
					<td>Library that should be 
					linked to LEX-generated program</td>
				</tr><tr>
					<td><code class="literal">LN_S</code></td>
					<td>Either 'ln 
					-s', 'cp -pR' or just 'ln'</td>
				</tr><tr>
					<td><code class="literal">MKDIR_P</code></td>
					<td>Either 'mkdir 
					-p' or 'install-sh'</td>
				</tr><tr>
					<td><code class="literal">RANLIB</code></td>
					<td>The ranlib program</td>
				</tr><tr>
					<td><code class="literal">SED</code></td>
					<td>The sed program</td>
				</tr><tr>
					<td><code class="literal">YACC</code></td>
					<td>The yacc program</td>
				</tr></table></div></section></section></section></body></html>
